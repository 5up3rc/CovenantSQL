variables:
  REVIEWDOG_VERSION: 0.9.8

before_script:
  # Setup dependency management tool
  - curl -L -s https://github.com/golang/dep/releases/download/v0.4.1/dep-linux-amd64 -o $GOPATH/bin/dep
  - chmod +x $GOPATH/bin/dep
  - go get github.com/mattn/goveralls
  - go get github.com/haya14busa/goverage
  - go get github.com/golang/lint/golint
  - dep ensure
  - mkdir -p ~/bin/ && export export PATH="~/bin/:$PATH"
  - curl -fSL https://github.com/haya14busa/reviewdog/releases/download/$REVIEWDOG_VERSION/reviewdog_linux_amd64 -o ~/bin/reviewdog && chmod +x ~/bin/reviewdog

rspec:
  script:
    - bash build.sh
    - go test -v -race $(go list ./... | grep -v "/vendor/")
    - goverage -coverprofile=coverage.txt ./...
    - bash <(curl -s https://codecov.io/bash)
    - >-
      golint ./... | grep -v 'vendor/' | grep -v 'server/' | grep -v 'utils/' | reviewdog -f=golint -ci=travis

